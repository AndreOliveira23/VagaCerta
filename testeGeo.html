<html>
  <head>
    <meta charset="utf-8" />
    <title>Search with a geocoding control</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />

    <!-- Load Leaflet from CDN -->

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@2.1.4/dist/esri-leaflet.js" integrity="sha512-m+BZ3OSlzGdYLqUBZt3u6eA0sH+Txdmq7cqA1u8/B2aTXviGMMLOfrKyiIW7181jbzZAY0u+3jWoiL61iLcTKQ==" crossorigin=""></script>


    <!-- Load Esri Leaflet Geocoder from CDN -->
    <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.9/dist/esri-leaflet-geocoder.css" integrity="sha512-v5YmWLm8KqAAmg5808pETiccEohtt8rPVMGQ1jA6jqkWVydV5Cuz3nJ9fQ7ittSxvuqsvI9RSGfVoKPaAJZ/AQ==" crossorigin="">
    <script src="https://unpkg.com/esri-leaflet-geocoder@2.2.9/dist/esri-leaflet-geocoder.js" integrity="sha512-QXchymy6PyEfYFQeOUuoz5pH5q9ng0eewZN8Sv0wvxq3ZhujTGF4eS/ySpnl6YfTQRWmA2Nn3Bezi9xuF8yNiw==" crossorigin=""></script>

    <!-- Add Materialize CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@materializecss/materialize@2.1.1/dist/css/materialize.min.css">

    <!-- Add Materialize JS -->
    <script src="https://cdn.jsdelivr.net/npm/@materializecss/materialize@2.1.1/dist/js/materialize.min.js"></script>

    <!-- Leaflet IconLayers Plugin-->
    <link rel="stylesheet" href="/Leaflet-IconLayers/src/iconLayers.css" />
    <script src="/Leaflet-IconLayers/src/iconLayers.js"></script>

    <!--BOx icons -->
    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <style>
      html,
      body,
      #map {
        padding: 0;
        margin: 0;
        height: 96%;
        width: 100%;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 14px;
        color: #323232;
      }

      #navbar{
        background-color: #007AFF;
        height: 10%;
        margin-top: -15;
      }

      #navbar-placeholder{
        text-align: center;
      }

      #logo-vaga-certa{
        float: left;
        margin: 5px;
        background-color: crimson;
        width: 10%;
      }

      #sidebar {
        float: left;
        height: 80%;
        width: 2%;
        background-color: blueviolet;
      }

      #map {
        border-radius: 13px;
      }

      #container {
        background: fixed;
        position: relative;
        top: 10px;
        left: 10px;
        z-index: 1000; /* Ensure it appears above the map */
        
      }

      #sidebar-toggle{
        position: relative;
        margin-bottom: 30%;
        margin-left: 30%;
      }



    </style>
  </head>
  <body>
    <div id = "navbar">
    
        <div id="logo-vaga-certa">[logo vaga certa]</div>
        <p id="navbar-placeholder">[navbar]</p>
    </div>

    <div>
    
        <div id="map"></div>

    

    </div>
    

    <!-- Modal Structure -->
    <div id="modal1" class="modal">
        <div class="modal-content">
            <h4>Park do Zé</h4>

            <div class="row">
                <div class="column">
                    <img src="img1.webp" alt="Snow" style="width:270px; height: 200px; border-radius: 10px;">
                </div>

                <div class="column">
                    <img src="img2.jpg" alt="Forest" style="width:270px; height: 200px; border-radius: 10px;">
                </div>

                <div class="column">
                    <img src="img3.jpg" alt="Mountains" style="width:270px; height: 200px; border-radius: 10px;">
                </div>
            </div> 

            <div class="card-content">
                <p>Endereço: Rua A, Número 100, Bairro B, Cidade C</p>
                <p>Lotação: 240 / 400 (60%)</p>
                <div class="rating">
                    <span class="star">&#9733;</span>
                    <span class="star">&#9733;</span>
                    <span class="star">&#9733;</span>
                    <span class="star">&#9733;</span>
                    <span class="star-half">&#9733;</span>
                </div>
                
                <button data-target="modal1" class="btn modal-trigger">Reservar vaga</button>
            </div>
        </div>
    </div>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('.modal');
    var instances = M.Modal.init(elems, {});
});



//Define a região inicial do mapa para SP
var map = L.map('map').setView([-23.5489,-46.6388], 10);

//Mostra o mapa
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);


//Barra de Pesquisa
var searchControl = L.esri.Geocoding.geosearch().addTo(map);

var results = L.layerGroup().addTo(map);

searchControl.on('results', function(data) {
  results.clearLayers();
  for (var i = data.results.length - 1; i >= 0; i--) {
    //results.addLayer(L.marker(data.results[i].latlng));
   
}
});


//Criando marcadores após clicar no mapa
map.on('click', function(ev){
    var latlng = map.mouseEventToLatLng(ev.originalEvent);
    console.log(latlng.lat + ', ' + latlng.lng);
    
    L.marker([latlng.lat, latlng.lng]).addTo(map).on('click', function() {
        var modalInstance = M.Modal.getInstance(document.getElementById('modal1'));
        modalInstance.open();
    }).bindPopup("Estacionamento");
  
});

//Menu icon
var searchButton = L.control({position: 'topleft'});

searchButton.onAdd = function(map) {
    var div = L.DomUtil.create('div', 'search-button');
    div.innerHTML = '<i class=\'bx bx-menu\' style="margin-top: 35px; background-color: black; font-size: 32px; border-radius: 2px" onclick="teste()"></i>';
    return div;
};

searchButton.addTo(map);

//Sidebar
var sideBar = L.control({position: 'topleft'});

sideBar.onAdd = function(map) {
    var div = L.DomUtil.create('div', 'sidebar2');
    div.innerHTML = '\
      <div id="sidebar" class="w3-sidebar w3-light-grey w3-bar-block" style="width:100%; height: 100%">\
            <h3 class="w3-bar-item">Menu</h3>\
            <a href="#" class="w3-bar-item w3-button">Link 1</a>\
            <a href="#" class="w3-bar-item w3-button">Link 2</a>\
            <a href="#" class="w3-bar-item w3-button">Link 3</a>\
        </div>\
    ';
    return div;
};

sideBar.addTo(map);




function teste(){
    var sidebar = document.getElementById("sidebar");
        if (sidebar.style.display === "none" || sidebar.style.display === "") {
          sidebar.style.display = "block";
        } else {
          sidebar.style.display = "none";
        }
};

var overlays = {
    "Layer 1": layer1,
    "Layer 2": layer2
};

L.control.layers(null, overlays, {collapsed: false}).addTo(map); 

    </script>
  </body>
</html>